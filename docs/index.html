<!DOCTYPE html>
<html>

<head>
    <title>Volume Calculator</title>
    <!-- Add Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <style>
        body {
            background-color: #1a1a1a;
            color: #fff;
        }

        .container {
            background-color: #2b2b2b;
            padding: 20px;
            border-radius: 5px;
            position: relative;
        }

        .form-control {
            background-color: #3c3c3c;
            color: #fff;
            border: none;
        }

        .btn-primary {
            background-color: #338aff;
            color: #fff;
            border: none;
        }

        .btn-primary:hover {
            background-color: #1f5cff;
            color: #fff;
        }

        #result {
            background-color: #3c3c3c;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
        }

        /* Center the title and result label */
        .title {
            text-align: center;
        }

        #result-label {
            text-align: center;
        }

        /* Remove up and down arrow selectors from input fields */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        /* Separate the calculator buttons with a small space */
        .calculator-btns {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .h-text {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 10px;
            color: #0d0d0d;
            /* A shade slightly off the background color */
            visibility: hidden;
        }

        /* Show text in white when hovered over the text */
        .container:hover .h-text:hover {
            color: #fff;
            /* White text color on hover */
            visibility: visible;
        }

        /* Small adjustments for mobile responsiveness */
        @media (max-width: 768px) {
            .form-control {
                font-size: 14px;
            }

            .btn-primary {
                font-size: 14px;
            }
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <h1 class="title mb-4">Volume Calculator</h1>
        <form id="calculatorForm">
            <!-- Form elements remain unchanged -->
        </form>

        <div class="result-container mt-4">
            <h2 id="result-label" class="mt-2">Result:</h2>
            <!-- Use a span with id "result" to allow inline styling -->
            <p id="result"></p>
        </div>

        <div class="h-text">JT - DOK2</div>
    </div>

    <!-- Scripts remain unchanged -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Add moment.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <script>
        function timeDifferenceInMinutes(time1, time2) {
            const timeFormat = "HH:mm";
            const datetime1 = moment(time1, timeFormat);
            const datetime2 = moment(time2, timeFormat);

            // Check if the end time is earlier than the current time (assuming same day)
            if (datetime2.isBefore(datetime1)) {
                // Add 1 day (24 hours) to the end time to account for overnight shift
                datetime2.add(1, 'day');
            }

            const timeDifference = datetime2.diff(datetime1, 'minutes');
            return timeDifference;
        }

        function checkVolumeFromRate() {
            const inductRate = parseFloat(document.getElementById("inductRate").value);
            if (!inductRate) {
                document.getElementById("result").innerHTML = '<span style="color: orange;">***Error: Please input an induct rate.***</span>';
                return; // Return early to prevent further calculations
            }

            const goalVolume = parseFloat(document.getElementById("goalVolume").value);
            const currentVolume = parseFloat(document.getElementById("currentVolume").value);
            const currentTimeInput = document.getElementById("currentTime").value;
            const endTimeInput = document.getElementById("endTime").value;

            // Convert input times to military time format (HH:MM)
            const currentMilitaryTime = convertToMilitaryTime(currentTimeInput);
            const endMilitaryTime = convertToMilitaryTime(endTimeInput);

            // Calculate the time difference in minutes between currentMilitaryTime and endMilitaryTime
            const timeRemaining = timeDifferenceInMinutes(currentMilitaryTime, endMilitaryTime);

            // Calculate the volume based on the corrected time difference
            const ratePerMin = inductRate / 60;
            const possibleVolume = ratePerMin * timeRemaining;
            const finalVolume = currentVolume + possibleVolume;

            // Display the result based on goal volume comparison
            let resultText = '';
            if (finalVolume >= goalVolume) {
                resultText = '<span style="color: green;">Final volume: ' + finalVolume + '</span>';
            } else if (finalVolume < goalVolume - 1000) {
                resultText = '<span style="color: red;">Final volume: ' + finalVolume + '</span>';
            } else {
                resultText = '<span style="color: yellow;">Final volume: ' + finalVolume + '</span>';
            }

            document.getElementById("result").innerHTML = resultText;
        }

        function calculateRateFromTime() {
            // Function definition remains unchanged
        }

        function convertToMilitaryTime(timeStr) {
            // Function definition remains unchanged
        }
    </script>
</body>

</html>